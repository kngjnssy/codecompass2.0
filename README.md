still needs lots of refactoring but the basic functions are afaik working
